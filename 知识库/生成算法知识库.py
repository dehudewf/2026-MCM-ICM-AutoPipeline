"""
算法知识库生成器
生成包含37-41个算法的Excel知识库，涵盖评价、预测、优化、统计、分类等类型
"""
import pandas as pd
import os

# 算法知识库数据结构
ALGORITHM_DATABASE = {
    "评价模型": [
        {
            "算法名称": "层次分析法 (AHP)",
            "适用场景": "多目标决策问题，需要综合考虑多个因素的权重",
            "优点": ["结构清晰", "适用性强", "能处理定性和定量指标", "易于理解", "适合群体决策", "逻辑性强"],
            "缺点": ["主观性较强", "指标过多时复杂度高", "一致性检验要求高", "对专家依赖大", "数据量大时计算繁琐", "权重确定困难"],
            "数学表达": "权重向量: w = (w₁, w₂, ..., wₙ)ᵀ, 满足 Aw = λₘₐₓw, CI = (λₘₐₓ - n)/(n-1)",
            "问题类型": "多目标评价、方案优选、权重确定",
            "组合策略": "可与模糊评价、TOPSIS结合使用"
        },
        {
            "算法名称": "TOPSIS法",
            "适用场景": "多属性决策问题，评价方案优劣",
            "优点": ["计算简单", "结果直观", "适用于大样本", "无需权重主观判断", "可处理多指标", "结果稳定"],
            "缺点": ["对数据分布敏感", "正负理想解选取影响大", "不适合小样本", "异常值影响大", "需要数据标准化", "无法处理缺失值"],
            "数学表达": "D⁺ᵢ = √Σ(xᵢⱼ - x⁺ⱼ)², D⁻ᵢ = √Σ(xᵢⱼ - x⁻ⱼ)², Cᵢ = D⁻ᵢ/(D⁺ᵢ + D⁻ᵢ)",
            "问题类型": "方案排序、综合评价、多目标优选",
            "组合策略": "可与熵权法、主成分分析结合"
        },
        {
            "算法名称": "模糊综合评价法",
            "适用场景": "评价指标模糊不确定的综合评价问题",
            "优点": ["处理模糊信息能力强", "综合性好", "适合定性评价", "结果直观", "灵活性高", "可量化主观判断"],
            "缺点": ["隶属度函数确定困难", "计算复杂", "结果解释性差", "需要大量先验知识", "参数敏感", "标准难统一"],
            "数学表达": "B = A ∘ R, 其中A为权重向量, R为模糊关系矩阵",
            "问题类型": "质量评价、风险评估、综合评分",
            "组合策略": "可与AHP、Delphi法结合"
        },
        {
            "算法名称": "主成分分析 (PCA)",
            "适用场景": "高维数据降维、特征提取",
            "优点": ["降维效果好", "去除冗余信息", "提高计算效率", "可视化友好", "无需标签", "理论基础扎实"],
            "缺点": ["损失部分信息", "解释性降低", "对异常值敏感", "线性假设局限", "主成分难解释", "需要标准化"],
            "数学表达": "Y = XW, 其中W为特征向量矩阵，满足协方差矩阵 Σ = XᵀX/n",
            "问题类型": "数据降维、特征选择、模式识别",
            "组合策略": "可作为预处理与分类/回归模型结合"
        },
        {
            "算法名称": "因子分析法",
            "适用场景": "发现变量间潜在结构，简化数据",
            "优点": ["揭示内在结构", "减少变量数量", "消除多重共线性", "提取公共因子", "可解释性强", "适合探索性分析"],
            "缺点": ["因子旋转选择困难", "因子命名主观", "模型假设严格", "样本量要求高", "计算复杂", "结果不唯一"],
            "数学表达": "X = ΛF + ε, 其中Λ为因子载荷矩阵, F为公共因子, ε为特殊因子",
            "问题类型": "结构分析、变量简化、潜在因子识别",
            "组合策略": "常与回归分析、聚类分析结合"
        },
        {
            "算法名称": "数据包络分析 (DEA)",
            "适用场景": "多投入多产出的效率评价",
            "优点": ["无需权重设定", "适合相对效率评价", "可处理多投入产出", "结果客观", "可识别改进方向", "非参数方法"],
            "缺点": ["对异常值敏感", "需要同质决策单元", "样本量要求高", "无法处理随机误差", "结果相对性强", "模型选择困难"],
            "数学表达": "max θ, s.t. Σλⱼxⱼ ≤ θx₀, Σλⱼyⱼ ≥ y₀, λⱼ ≥ 0",
            "问题类型": "效率评价、绩效考核、资源配置",
            "组合策略": "可与Malmquist指数、Tobit回归结合"
        }
    ],
    
    "预测模型": [
        {
            "算法名称": "时间序列分析 (ARIMA)",
            "适用场景": "单变量时间序列预测，数据具有趋势和季节性",
            "优点": ["理论成熟", "预测精度高", "适合短期预测", "模型可解释", "参数估计稳定", "适用范围广"],
            "缺点": ["需要平稳性", "参数选择复杂", "长期预测效果差", "无法处理多变量", "突变点处理困难", "计算量大"],
            "数学表达": "ARIMA(p,d,q): ∇ᵈyₜ = φ₁∇ᵈyₜ₋₁ + ... + φₚ∇ᵈyₜ₋ₚ + εₜ + θ₁εₜ₋₁ + ... + θᵧεₜ₋ᵧ",
            "问题类型": "销量预测、价格预测、需求预测",
            "组合策略": "可与机器学习模型融合，如ARIMA+LSTM"
        },
        {
            "算法名称": "灰色预测模型 (GM)",
            "适用场景": "小样本、贫信息系统的预测",
            "优点": ["样本要求低", "计算简单", "短期预测准确", "适合指数增长", "无需大量历史数据", "模型简洁"],
            "缺点": ["长期预测误差大", "对波动数据效果差", "模型假设限制", "精度有限", "不适合周期性数据", "外推能力弱"],
            "数学表达": "GM(1,1): dx⁽¹⁾/dt + ax⁽¹⁾ = u, 解为 x̂⁽¹⁾(k+1) = (x⁽⁰⁾(1) - u/a)e⁻ᵃᵏ + u/a",
            "问题类型": "经济预测、人口预测、能源消耗预测",
            "组合策略": "可与马尔可夫链、神经网络结合"
        },
        {
            "算法名称": "神经网络 (BP/LSTM)",
            "适用场景": "复杂非线性关系建模，大数据预测",
            "优点": ["非线性拟合能力强", "适应性好", "自学习能力", "容错性高", "可处理高维数据", "预测精度高"],
            "缺点": ["需要大量数据", "训练时间长", "易过拟合", "可解释性差", "参数调优困难", "计算资源需求大"],
            "数学表达": "LSTM: fₜ = σ(Wf[hₜ₋₁,xₜ] + bf), iₜ = σ(Wi[hₜ₋₁,xₜ] + bi), oₜ = σ(Wo[hₜ₋₁,xₜ] + bo)",
            "问题类型": "时序预测、分类、回归、图像识别",
            "组合策略": "可与注意力机制、Transformer结合"
        },
        {
            "算法名称": "支持向量机回归 (SVR)",
            "适用场景": "小样本非线性回归预测",
            "优点": ["泛化能力强", "处理高维数据", "避免过拟合", "理论基础坚实", "核技巧灵活", "全局最优"],
            "缺点": ["参数选择困难", "大样本计算慢", "多分类效果一般", "核函数选择依赖经验", "对缺失值敏感", "解释性差"],
            "数学表达": "min ½||w||² + C Σξᵢ, s.t. |yᵢ - wᵀφ(xᵢ) - b| ≤ ε + ξᵢ",
            "问题类型": "回归预测、时间序列、金融预测",
            "组合策略": "可与粒子群优化参数调优"
        },
        {
            "算法名称": "随机森林回归",
            "适用场景": "多特征预测问题，处理复杂非线性关系",
            "优点": ["准确率高", "抗过拟合", "可处理高维数据", "特征重要性评估", "并行化", "鲁棒性强"],
            "缺点": ["模型较大", "实时性差", "可解释性弱", "对噪声敏感", "参数调优复杂", "训练时间长"],
            "数学表达": "ŷ = (1/B)ΣB₍b₌₁₎ f⁽ᵇ⁾(x), 其中f⁽ᵇ⁾为第b棵决策树",
            "问题类型": "回归、分类、特征选择",
            "组合策略": "可与XGBoost、LightGBM集成"
        },
        {
            "算法名称": "XGBoost/LightGBM",
            "适用场景": "大规模数据预测，竞赛级精度要求",
            "优点": ["精度极高", "速度快", "防过拟合", "特征重要性", "处理缺失值", "工程化完善"],
            "缺点": ["参数众多", "调参复杂", "可解释性一般", "需要特征工程", "对异常值敏感", "内存占用大"],
            "数学表达": "Obj = ΣL(yᵢ, ŷᵢ) + Σ Ω(fₖ), Ω(f) = γT + ½λ||w||²",
            "问题类型": "回归、分类、排序",
            "组合策略": "可与特征工程、Stacking集成"
        },
        {
            "算法名称": "Prophet时间序列",
            "适用场景": "具有趋势、季节性和节假日效应的时间序列",
            "优点": ["自动处理季节性", "容忍缺失值", "适合业务预测", "可解释性强", "参数少", "易于使用"],
            "缺点": ["不适合高频数据", "对突变响应慢", "计算速度一般", "模型假设限制", "精度不如深度学习", "外推能力有限"],
            "数学表达": "y(t) = g(t) + s(t) + h(t) + εₜ, g为趋势, s为季节性, h为节假日",
            "问题类型": "业务预测、销量预测、网站流量",
            "组合策略": "可与ARIMA、LSTM组合"
        }
    ],
    
    "优化模型": [
        {
            "算法名称": "线性规划",
            "适用场景": "资源分配、生产计划等线性目标约束问题",
            "优点": ["理论完善", "求解稳定", "结果可靠", "计算高效", "适合大规模问题", "全局最优"],
            "缺点": ["仅限线性关系", "约束条件严格", "对数据要求高", "不适合非线性", "模型假设强", "灵活性差"],
            "数学表达": "max/min cᵀx, s.t. Ax ≤ b, x ≥ 0",
            "问题类型": "资源分配、运输问题、生产计划",
            "组合策略": "可与整数规划、动态规划结合"
        },
        {
            "算法名称": "整数规划",
            "适用场景": "决策变量必须为整数的优化问题",
            "优点": ["适合离散决策", "结果实用", "应用广泛", "模型直观", "约束灵活", "可处理0-1变量"],
            "缺点": ["NP难问题", "计算复杂度高", "大规模求解困难", "可能无可行解", "对求解器依赖大", "时间消耗大"],
            "数学表达": "max/min cᵀx, s.t. Ax ≤ b, x ∈ ℤⁿ",
            "问题类型": "选址问题、排班问题、分配问题",
            "组合策略": "可与分支定界、遗传算法结合"
        },
        {
            "算法名称": "动态规划",
            "适用场景": "多阶段决策问题，具有最优子结构",
            "优点": ["保证全局最优", "适合分段决策", "理论清晰", "应用广泛", "可处理复杂约束", "算法稳定"],
            "缺点": ["维度灾难", "状态设计困难", "计算量大", "内存需求高", "不适合连续变量", "模型复杂"],
            "数学表达": "V(k,s) = max{r(s,a) + βV(k+1, T(s,a))}, Bellman方程",
            "问题类型": "路径规划、库存管理、投资决策",
            "组合策略": "可与贪心算法、强化学习结合"
        },
        {
            "算法名称": "遗传算法",
            "适用场景": "复杂非线性全局优化问题",
            "优点": ["全局搜索能力强", "不依赖梯度", "并行性好", "适应性强", "鲁棒性高", "易于实现"],
            "缺点": ["参数敏感", "可能早熟收敛", "计算量大", "精度有限", "不保证最优", "收敛慢"],
            "数学表达": "选择-交叉-变异: P(t+1) = M(C(S(P(t)))), 适应度函数 f(x)",
            "问题类型": "参数优化、组合优化、机器学习调参",
            "组合策略": "可与模拟退火、粒子群结合"
        },
        {
            "算法名称": "粒子群优化 (PSO)",
            "适用场景": "连续函数优化，参数寻优",
            "优点": ["实现简单", "收敛快", "参数少", "全局搜索", "适合连续优化", "并行化容易"],
            "缺点": ["易陷入局部最优", "参数选择影响大", "高维效果差", "收敛精度有限", "缺乏理论分析", "早熟问题"],
            "数学表达": "vᵢᵈ = wvᵢᵈ + c₁r₁(pᵢᵈ - xᵢᵈ) + c₂r₂(pgᵈ - xᵢᵈ), xᵢᵈ = xᵢᵈ + vᵢᵈ",
            "问题类型": "函数优化、神经网络训练、参数调优",
            "组合策略": "可与遗传算法、模拟退火结合"
        },
        {
            "算法名称": "模拟退火算法",
            "适用场景": "组合优化、离散优化问题",
            "优点": ["跳出局部最优", "理论保证", "适应性强", "对初值不敏感", "算法简单", "应用广泛"],
            "缺点": ["收敛慢", "参数难调", "不适合大规模", "效率较低", "温度策略影响大", "结果随机性"],
            "数学表达": "接受概率: P(ΔE) = exp(-ΔE/T), 温度下降: Tₖ₊₁ = αTₖ",
            "问题类型": "TSP问题、调度问题、布局优化",
            "组合策略": "可与禁忌搜索、遗传算法混合"
        },
        {
            "算法名称": "贝叶斯优化",
            "适用场景": "黑盒函数优化，超参数调优",
            "优点": ["样本效率高", "适合昂贵函数", "全局优化", "理论支撑", "不需要梯度", "收敛快"],
            "缺点": ["高维困难", "GP拟合耗时", "采集函数选择难", "实现复杂", "对核函数敏感", "可扩展性差"],
            "数学表达": "采集函数: α(x) = EI(x) = E[max(f(x) - f(x⁺), 0)], 高斯过程后验",
            "问题类型": "超参数优化、实验设计、A/B测试",
            "组合策略": "可与TPE、网格搜索结合"
        }
    ],
    
    "统计模型": [
        {
            "算法名称": "回归分析 (线性/非线性)",
            "适用场景": "变量间关系建模与预测",
            "优点": ["理论成熟", "解释性强", "计算简单", "应用广泛", "可检验显著性", "易于实现"],
            "缺点": ["假设条件多", "对异常值敏感", "多重共线性影响", "非线性拟合有限", "需要大样本", "模型选择困难"],
            "数学表达": "y = β₀ + β₁x₁ + ... + βₚxₚ + ε, ε ~ N(0, σ²)",
            "问题类型": "关系建模、影响因素分析、预测",
            "组合策略": "可与岭回归、Lasso、逐步回归结合"
        },
        {
            "算法名称": "假设检验 (t/F/χ²)",
            "适用场景": "统计推断、参数显著性检验",
            "优点": ["理论严密", "结论可靠", "应用标准化", "可控制误差", "适合小样本", "解释清晰"],
            "缺点": ["假设条件严格", "对数据分布敏感", "样本量影响大", "单侧双侧选择", "多重检验问题", "实际意义有限"],
            "数学表达": "t = (x̄ - μ)/(s/√n), F = MS₁/MS₂, χ² = Σ(Oᵢ - Eᵢ)²/Eᵢ",
            "问题类型": "均值比较、方差检验、独立性检验",
            "组合策略": "可与置信区间、方差分析结合"
        },
        {
            "算法名称": "相关分析 (Pearson/Spearman)",
            "适用场景": "变量间相关性度量",
            "优点": ["计算简单", "结果直观", "适用范围广", "可检验显著性", "无需假设因果", "标准化结果"],
            "缺点": ["只衡量线性关系", "对异常值敏感", "不能推断因果", "样本量影响", "混淆变量干扰", "相关不等于独立"],
            "数学表达": "Pearson: r = Σ(xᵢ-x̄)(yᵢ-ȳ)/√[Σ(xᵢ-x̄)²Σ(yᵢ-ȳ)²]",
            "问题类型": "变量关系、特征选择、多重共线性检查",
            "组合策略": "可与回归分析、PCA结合"
        },
        {
            "算法名称": "方差分析 (ANOVA)",
            "适用场景": "多组均值比较，因素效应检验",
            "优点": ["多组比较", "控制误差", "分析交互效应", "理论成熟", "结果可靠", "应用广泛"],
            "缺点": ["假设严格", "需要正态性", "方差齐性要求", "样本量敏感", "后续检验需要", "设计复杂"],
            "数学表达": "F = MSB/MSW, SST = SSB + SSW, MSB = SSB/(k-1)",
            "问题类型": "实验设计、因素分析、组间比较",
            "组合策略": "可与多重比较、协方差分析结合"
        },
        {
            "算法名称": "Bootstrap自助法",
            "适用场景": "小样本统计推断、置信区间估计",
            "优点": ["无需分布假设", "适合小样本", "简单易用", "精度高", "适用性广", "稳健性好"],
            "缺点": ["计算量大", "依赖原样本", "极端情况效果差", "理论支撑弱", "抽样偏差", "时间复杂度高"],
            "数学表达": "重抽样B次: θ̂* = (1/B)ΣB₍b₌₁₎ θ̂⁽ᵇ⁾, CI = [θ̂₍α/₂₎, θ̂₍₁₋α/₂₎]",
            "问题类型": "置信区间、标准误估计、假设检验",
            "组合策略": "可与蒙特卡洛、交叉验证结合"
        },
        {
            "算法名称": "格兰杰因果检验",
            "适用场景": "时间序列因果关系检验",
            "优点": ["检验因果方向", "适合时间序列", "理论清晰", "易于实现", "统计显著性", "应用广泛"],
            "缺点": ["仅限线性关系", "需要平稳性", "滞后阶数选择", "不代表真实因果", "样本量要求", "双向因果难处理"],
            "数学表达": "H₀: Σβᵢ = 0, F检验: F = (RSS₀ - RSS₁)/p / (RSS₁/(n-k))",
            "问题类型": "因果推断、经济分析、时序建模",
            "组合策略": "可与VAR模型、协整检验结合"
        }
    ],
    
    "分类算法": [
        {
            "算法名称": "逻辑回归",
            "适用场景": "二分类问题，需要概率输出",
            "优点": ["解释性强", "计算高效", "概率输出", "易于实现", "特征重要性", "正则化"],
            "缺点": ["仅限线性边界", "对特征工程依赖", "多分类效果一般", "需要数值特征", "异常值敏感", "假设限制"],
            "数学表达": "P(y=1|x) = 1/(1 + e⁻⁽ʷᵀˣ⁺ᵇ⁾), 损失函数: L = -Σ[yᵢlogŷᵢ + (1-yᵢ)log(1-ŷᵢ)]",
            "问题类型": "二分类、风险预测、点击率预估",
            "组合策略": "可与特征工程、集成学习结合"
        },
        {
            "算法名称": "决策树 (CART/ID3/C4.5)",
            "适用场景": "分类与回归问题，需要可解释性",
            "优点": ["可解释性强", "处理非线性", "无需标准化", "处理缺失值", "特征选择", "可视化直观"],
            "缺点": ["易过拟合", "不稳定", "偏向多值特征", "对噪声敏感", "偏差较大", "局部最优"],
            "数学表达": "Gini: G = 1 - Σpₖ², 信息增益: IG = H(D) - Σ|Dᵥ|/|D|H(Dᵥ)",
            "问题类型": "分类、回归、特征选择",
            "组合策略": "可集成为随机森林、GBDT"
        },
        {
            "算法名称": "支持向量机 (SVM)",
            "适用场景": "小样本高维分类问题",
            "优点": ["泛化能力强", "核技巧强大", "全局最优", "适合高维", "理论完善", "鲁棒性好"],
            "缺点": ["计算复杂度高", "参数调优难", "核函数选择", "大样本慢", "多分类复杂", "解释性差"],
            "数学表达": "max Σαᵢ - ½ΣΣαᵢαⱼyᵢyⱼK(xᵢ,xⱼ), s.t. Σαᵢyᵢ = 0, 0 ≤ αᵢ ≤ C",
            "问题类型": "二分类、多分类、异常检测",
            "组合策略": "可与网格搜索、集成学习结合"
        },
        {
            "算法名称": "朴素贝叶斯",
            "适用场景": "文本分类、垃圾邮件识别",
            "优点": ["实现简单", "速度快", "适合高维", "少量数据可用", "概率输出", "可解释性好"],
            "缺点": ["特征独立假设强", "对特征依赖敏感", "连续值处理弱", "概率估计偏差", "数据不平衡影响", "精度有限"],
            "数学表达": "P(C|X) = P(X|C)P(C)/P(X) = P(C)Π P(xᵢ|C) / P(X)",
            "问题类型": "文本分类、情感分析、推荐系统",
            "组合策略": "可与TF-IDF、词嵌入结合"
        },
        {
            "算法名称": "K近邻 (KNN)",
            "适用场景": "简单分类问题，小数据集",
            "优点": ["简单易懂", "无需训练", "适合多分类", "非参数方法", "理论简单", "易于实现"],
            "缺点": ["计算量大", "维度灾难", "k值选择困难", "样本不平衡敏感", "存储开销大", "实时性差"],
            "数学表达": "ŷ = argmax Σᵏ I(yᵢ = c), 距离: d(x,x') = √Σ(xᵢ - x'ᵢ)²",
            "问题类型": "分类、回归、推荐",
            "组合策略": "可与降维、距离度量学习结合"
        },
        {
            "算法名称": "集成学习 (Bagging/Boosting/Stacking)",
            "适用场景": "提升模型精度，竞赛场景",
            "优点": ["精度高", "鲁棒性强", "减少过拟合", "组合多模型", "灵活性好", "泛化能力强"],
            "缺点": ["计算复杂", "可解释性差", "训练时间长", "参数多", "工程复杂", "资源消耗大"],
            "数学表达": "Bagging: ŷ = (1/M)Σfₘ(x), Boosting: F(x) = Σαₘhₘ(x)",
            "问题类型": "分类、回归、排序",
            "组合策略": "可使用RF、GBDT、XGBoost等具体实现"
        }
    ],
    
    "重要算法": [
        {
            "算法名称": "聚类分析 (K-means/层次聚类)",
            "适用场景": "无监督学习、数据分组、市场细分",
            "优点": ["无需标签", "发现数据结构", "应用广泛", "算法简单", "可视化直观", "易于实现"],
            "缺点": ["需预设类别数", "对初值敏感", "对异常值敏感", "不适合非凸簇", "距离度量影响大", "结果不稳定"],
            "数学表达": "K-means: min Σᵏ Σₓ∈Cₖ ||x - μₖ||², μₖ为第k类中心",
            "问题类型": "客户细分、图像分割、异常检测",
            "组合策略": "可与PCA降维、DBSCAN结合"
        },
        {
            "算法名称": "卷积神经网络 (CNN)",
            "适用场景": "图像识别、计算机视觉任务",
            "优点": ["图像处理强", "参数共享", "局部连接", "平移不变性", "精度高", "端到端学习"],
            "缺点": ["需要大量数据", "计算资源高", "训练时间长", "可解释性差", "对抗样本脆弱", "超参数多"],
            "数学表达": "卷积: Sᵢⱼ = (I * K)ᵢⱼ = ΣₘΣₙI(i+m, j+n)K(m,n), 池化: maxpool",
            "问题类型": "图像分类、目标检测、语义分割",
            "组合策略": "可与ResNet、Attention、YOLO结合"
        },
        {
            "算法名称": "循环神经网络 (RNN/LSTM/GRU)",
            "适用场景": "序列建模、时间序列、自然语言处理",
            "优点": ["处理序列数据", "记忆能力", "可变长度输入", "时序建模", "应用广泛", "理论成熟"],
            "缺点": ["梯度消失", "训练困难", "计算慢", "长依赖问题", "参数多", "易过拟合"],
            "数学表达": "hₜ = tanh(Wₓₓxₜ + Wₕₕhₜ₋₁ + b), yₜ = Wₕyₕₜ + c",
            "问题类型": "文本生成、机器翻译、语音识别",
            "组合策略": "可与Attention、Transformer结合"
        },
        {
            "算法名称": "强化学习 (Q-Learning/DQN/PPO)",
            "适用场景": "游戏AI、机器人控制、决策优化",
            "优点": ["自主学习", "适应动态环境", "无需标签", "延迟奖励", "策略优化", "探索能力"],
            "缺点": ["样本效率低", "训练不稳定", "奖励设计难", "计算资源大", "可解释性差", "收敛慢"],
            "数学表达": "Q(s,a) ← Q(s,a) + α[r + γmax Q(s',a') - Q(s,a)]",
            "问题类型": "游戏、机器人、推荐系统",
            "组合策略": "可与深度学习、蒙特卡洛树结合"
        },
        {
            "算法名称": "迁移学习",
            "适用场景": "小样本学习、领域适应、预训练模型应用",
            "优点": ["节省数据", "训练快", "利用已有知识", "泛化能力强", "适合小样本", "实用性高"],
            "缺点": ["领域差异影响", "负迁移风险", "模型选择困难", "微调技巧", "可解释性差", "依赖源任务"],
            "数学表达": "Lₜₐᵣgₑₜ = L(fₛₒᵤᵣcₑ(x; θₛ); θₜ) + λR(θₜ), 微调部分或全部参数",
            "问题类型": "图像分类、NLP、语音识别",
            "组合策略": "可与预训练模型(BERT/GPT/ResNet)结合"
        },
        {
            "算法名称": "注意力机制 (Attention/Transformer)",
            "适用场景": "NLP、机器翻译、多模态学习",
            "优点": ["捕捉长依赖", "可解释性", "并行化", "精度高", "灵活性强", "迁移能力强"],
            "缺点": ["计算复杂度高", "内存消耗大", "训练资源需求大", "位置编码设计", "过拟合风险", "工程复杂"],
            "数学表达": "Attention(Q,K,V) = softmax(QKᵀ/√dₖ)V, Multi-head",
            "问题类型": "机器翻译、文本生成、问答系统",
            "组合策略": "可用于BERT、GPT、ViT等模型"
        },
        {
            "算法名称": "图神经网络 (GNN/GCN)",
            "适用场景": "图结构数据、社交网络、分子预测",
            "优点": ["处理图数据", "捕捉关系", "归纳能力", "应用新颖", "泛化性好", "理论发展快"],
            "缺点": ["计算复杂", "过平滑问题", "深度限制", "训练困难", "工程复杂", "应用场景受限"],
            "数学表达": "H⁽ˡ⁺¹⁾ = σ(D̃⁻½ÃD̃⁻½H⁽ˡ⁾W⁽ˡ⁾), Ã = A + I",
            "问题类型": "节点分类、链接预测、图生成",
            "组合策略": "可与注意力机制、Pooling结合"
        },
        {
            "算法名称": "生成对抗网络 (GAN)",
            "适用场景": "图像生成、数据增强、风格迁移",
            "优点": ["生成能力强", "数据增强", "无需标签", "创造性", "应用广泛", "效果逼真"],
            "缺点": ["训练不稳定", "模式崩塌", "难以评估", "超参数敏感", "计算资源大", "收敛困难"],
            "数学表达": "min_G max_D V(D,G) = E_x[logD(x)] + E_z[log(1-D(G(z)))]",
            "问题类型": "图像生成、超分辨率、风格转换",
            "组合策略": "可与VAE、条件GAN、StyleGAN结合"
        }
    ]
}


def generate_excel():
    """生成Excel知识库"""
    output_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), "知识库")
    os.makedirs(output_dir, exist_ok=True)
    
    output_file = os.path.join(output_dir, "算法知识库_37_algorithms.xlsx")
    
    all_data = []
    
    for category, algorithms in ALGORITHM_DATABASE.items():
        for algo in algorithms:
            row = {
                "算法类别": category,
                "算法名称": algo["算法名称"],
                "适用场景": algo["适用场景"],
                "优点1": algo["优点"][0] if len(algo["优点"]) > 0 else "",
                "优点2": algo["优点"][1] if len(algo["优点"]) > 1 else "",
                "优点3": algo["优点"][2] if len(algo["优点"]) > 2 else "",
                "优点4": algo["优点"][3] if len(algo["优点"]) > 3 else "",
                "优点5": algo["优点"][4] if len(algo["优点"]) > 4 else "",
                "优点6": algo["优点"][5] if len(algo["优点"]) > 5 else "",
                "缺点1": algo["缺点"][0] if len(algo["缺点"]) > 0 else "",
                "缺点2": algo["缺点"][1] if len(algo["缺点"]) > 1 else "",
                "缺点3": algo["缺点"][2] if len(algo["缺点"]) > 2 else "",
                "缺点4": algo["缺点"][3] if len(algo["缺点"]) > 3 else "",
                "缺点5": algo["缺点"][4] if len(algo["缺点"]) > 4 else "",
                "缺点6": algo["缺点"][5] if len(algo["缺点"]) > 5 else "",
                "数学表达": algo["数学表达"],
                "问题类型": algo["问题类型"],
                "组合策略": algo["组合策略"]
            }
            all_data.append(row)
    
    df = pd.DataFrame(all_data)
    
    # 写入Excel
    with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
        df.to_excel(writer, sheet_name='算法知识库', index=False)
        
        # 自动调整列宽
        worksheet = writer.sheets['算法知识库']
        for column in worksheet.columns:
            max_length = 0
            column_letter = column[0].column_letter
            for cell in column:
                try:
                    if len(str(cell.value)) > max_length:
                        max_length = len(str(cell.value))
                except:
                    pass
            adjusted_width = min(max_length + 2, 50)
            worksheet.column_dimensions[column_letter].width = adjusted_width
    
    print("=" * 80)
    print("算法知识库生成完成！")
    print("=" * 80)
    print(f"文件位置: {output_file}")
    print(f"算法总数: {len(all_data)}")
    print("\n各类别算法数量:")
    for category, algorithms in ALGORITHM_DATABASE.items():
        print(f"  • {category}: {len(algorithms)}个")
    
    print("\n知识库包含:")
    print("  • 算法名称、类别、适用场景")
    print("  • 6个优点、6个缺点")
    print("  • 数学表达式")
    print("  • 问题类型、组合策略")
    print("\n建模竞赛必备参考资料！")
    print("=" * 80)
    
    return output_file


if __name__ == '__main__':
    generate_excel()
