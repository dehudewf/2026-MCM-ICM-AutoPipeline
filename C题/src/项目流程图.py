"""
MCM Cé¢˜ - å¥¥è¿å¥–ç‰Œé¢„æµ‹ç³»ç»Ÿ - é¡¹ç›®æ•´ä½“æµç¨‹
Olympic Medal Prediction System - Complete Project Workflow
2028 Los Angeles Olympics

ç”Ÿæˆæ–¹å¼ï¼špython3 é¡¹ç›®æµç¨‹å›¾.py
"""

import os

# ============================================================================
# é¡¹ç›®æ•´ä½“æµç¨‹å›¾ (Mermaidæ ¼å¼)
# ============================================================================

MERMAID_FLOWCHART = """
```mermaid
graph TB
    subgraph æ•°æ®å±‚["ğŸ“Š Layer 1: æ•°æ®å¤„ç†å±‚"]
        A1[summerOly_medal_counts.csv] --> B1[DataLoader<br/>æ•°æ®åŠ è½½å™¨]
        A2[summerOly_hosts.csv] --> B1
        A3[summerOly_programs.csv] --> B1
        A4[summerOly_athletes.csv] --> B1
        B1 --> C1[DataMerger<br/>æ•°æ®åˆå¹¶å™¨]
        C1 --> D1[DataPreprocessor<br/>æ•°æ®é¢„å¤„ç†]
        D1 --> D2[ç¼ºå¤±å€¼å¤„ç†]
        D1 --> D3[å¼‚å¸¸å€¼æ£€æµ‹]
        D1 --> D4[æ•°æ®æ ‡å‡†åŒ–]
    end
    
    subgraph ç‰¹å¾å±‚["ğŸ”§ Layer 2: ç‰¹å¾å·¥ç¨‹å±‚"]
        D2 --> E1[FeatureEngineer<br/>ç‰¹å¾å·¥ç¨‹å™¨]
        D3 --> E1
        D4 --> E1
        E1 --> F1[æ»åç‰¹å¾<br/>lag1/lag2/lag3]
        E1 --> F2[æ»šåŠ¨ç»Ÿè®¡<br/>ma3/ma5/std3]
        E1 --> F3[è¶‹åŠ¿ç‰¹å¾<br/>trend/momentum]
        E1 --> F4[ä¸»åŠå›½ç‰¹å¾<br/>is_host]
    end
    
    subgraph æ¨¡å‹å±‚["ğŸ¤– Layer 3: æ¨¡å‹è®­ç»ƒå±‚"]
        F1 --> G1[XGBoost]
        F2 --> G1
        F3 --> G1
        F4 --> G1
        
        F1 --> G2[LightGBM]
        F2 --> G2
        F3 --> G2
        F4 --> G2
        
        F1 --> G3[RandomForest]
        F2 --> G3
        F3 --> G3
        F4 --> G3
        
        F1 --> G4[ARIMA<br/>æ—¶é—´åºåˆ—]
        
        G1 --> H1[EnsemblePredictor<br/>æ¨¡å‹èåˆ]
        G2 --> H1
        G3 --> H1
        G4 --> H1
    end
    
    subgraph ä¼˜åŒ–å±‚["âš¡ Layer 4: ä¼˜åŒ–è°ƒæ•´å±‚"]
        H1 --> I1[HostEffectAdjuster<br/>ä¸»åŠå›½æ•ˆåº”è°ƒæ•´]
        I1 --> I2[+20% ç¾å›½ä¸»åœºä¼˜åŠ¿]
        I2 --> J1[BayesianUncertainty<br/>è´å¶æ–¯ä¸ç¡®å®šæ€§]
        J1 --> J2[Bootstrap<br/>1000æ¬¡é‡é‡‡æ ·]
        J2 --> J3[95%ç½®ä¿¡åŒºé—´]
    end
    
    subgraph éªŒè¯å±‚["âœ… Layer 5: æ¨¡å‹éªŒè¯å±‚"]
        H1 --> K1[BacktestValidator<br/>å›æµ‹éªŒè¯]
        K1 --> K2[æ—¶é—´åºåˆ—äº¤å‰éªŒè¯<br/>3-fold]
        K2 --> K3[ModelEvaluator<br/>æŒ‡æ ‡è¯„ä¼°]
        K3 --> K4[RMSE/MAE/RÂ²]
        
        H1 --> L1[SensitivityAnalyzer<br/>æ•æ„Ÿæ€§åˆ†æ]
        L1 --> L2[ç‰¹å¾æ•æ„Ÿåº¦æ’åº]
    end
    
    subgraph åˆ†æå±‚["ğŸ“ˆ Layer 6: æ·±åº¦åˆ†æå±‚"]
        J3 --> M1[StatisticalTests<br/>ç»Ÿè®¡æ£€éªŒ]
        M1 --> M2[ADFå¹³ç¨³æ€§æ£€éªŒ]
        M1 --> M3[Grangerå› æœæ£€éªŒ]
        M1 --> M4[Pearson/Spearmanç›¸å…³]
        
        J3 --> N1[RegionalAnalyzer<br/>åŒºåŸŸåˆ†æ]
        N1 --> N2[å—ç¾å›½å®¶åˆ†æ]
        N1 --> N3[åœ°ç†åˆ†å¸ƒçƒ­åŠ›å›¾]
        
        J3 --> O1[CoachEffectAnalyzer<br/>æ•™ç»ƒæ•ˆåº”]
        O1 --> O2[è‚¯å°¼äºšæ¡ˆä¾‹+51.7%]
        O1 --> O3[ç‰™ä¹°åŠ æ¡ˆä¾‹+186%]
    end
    
    subgraph è¾“å‡ºå±‚["ğŸ“„ Layer 7: è¾“å‡ºç”Ÿæˆå±‚"]
        J3 --> P1[PredictionReporter<br/>æŠ¥å‘Šç”Ÿæˆå™¨]
        K4 --> P1
        L2 --> P1
        M4 --> P1
        N3 --> P1
        O3 --> P1
        
        P1 --> Q1[predictions_2028.csv]
        P1 --> Q2[summary_report.txt]
        P1 --> Q3[comprehensive_report.txt]
        P1 --> Q4[enhanced_report.txt]
        
        P1 --> R1[Visualizer<br/>å¯è§†åŒ–å™¨]
        R1 --> R2[17ä¸ªPNGå›¾è¡¨]
    end
    
    subgraph è¾“å‡ºæ–‡ä»¶["ğŸ“ è¾“å‡ºæ–‡ä»¶"]
        Q1 --> S1[output/]
        Q2 --> S1
        Q3 --> S1
        Q4 --> S1
        R2 --> S2[output/figures/]
    end
```
"""

# ============================================================================
# è¯¦ç»†æµç¨‹è¯´æ˜
# ============================================================================

WORKFLOW_DESCRIPTION = """
================================================================================
                MCM Cé¢˜ - å¥¥è¿å¥–ç‰Œé¢„æµ‹ç³»ç»Ÿ - é¡¹ç›®æ•´ä½“æµç¨‹
                Olympic Medal Prediction System Workflow
                        2028 Los Angeles Olympics
================================================================================

ã€ä¸€ã€é¡¹ç›®æ¶æ„æ¦‚è§ˆã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æœ¬é¡¹ç›®é‡‡ç”¨ 7å±‚æ¶æ„è®¾è®¡ï¼Œä»æ•°æ®è¾“å…¥åˆ°ç»“æœè¾“å‡ºå½¢æˆå®Œæ•´çš„é¢„æµ‹ç®¡é“ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: æ•°æ®å¤„ç†å±‚ (Data Processing)                                      â”‚
â”‚  Layer 2: ç‰¹å¾å·¥ç¨‹å±‚ (Feature Engineering)                                  â”‚
â”‚  Layer 3: æ¨¡å‹è®­ç»ƒå±‚ (Model Training)                                       â”‚
â”‚  Layer 4: ä¼˜åŒ–è°ƒæ•´å±‚ (Optimization)                                         â”‚
â”‚  Layer 5: æ¨¡å‹éªŒè¯å±‚ (Validation)                                           â”‚
â”‚  Layer 6: æ·±åº¦åˆ†æå±‚ (Advanced Analysis)                                    â”‚
â”‚  Layer 7: è¾“å‡ºç”Ÿæˆå±‚ (Output Generation)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ã€äºŒã€Layer 1: æ•°æ®å¤„ç†å±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‚ è¾“å…¥æ–‡ä»¶ (data/):
   â”œâ”€â”€ summerOly_medal_counts.csv  (å¿…éœ€) - å†å²å¥–ç‰Œæ•°æ® 1896-2024
   â”œâ”€â”€ summerOly_hosts.csv         (å¿…éœ€) - ä¸»åŠå›½æ•°æ®
   â”œâ”€â”€ summerOly_programs.csv      (å¯é€‰) - é¡¹ç›®æ•°æ®
   â””â”€â”€ summerOly_athletes.csv      (å¯é€‰) - è¿åŠ¨å‘˜æ•°æ®

ğŸ”§ å¤„ç†æ¨¡å—:
   1. DataLoader (src/data/loader.py)
      - åŠ è½½CSVæ–‡ä»¶
      - å¤„ç†å¤šç§ç¼–ç æ ¼å¼ (UTF-8, Latin-1, CP1252)
      
   2. DataMerger (src/data/merger.py)
      - åˆå¹¶å¥–ç‰Œæ•°æ®ä¸ä¸»åŠå›½æ•°æ®
      - æŒ‰å¹´ä»½å’Œå›½å®¶å…³è”
      
   3. DataPreprocessor (src/data/preprocessor.py)
      - ç¼ºå¤±å€¼å¤„ç†: impute_missing_mean()
      - å¼‚å¸¸å€¼æ£€æµ‹: detect_outliers_zscore(), detect_outliers_iqr()
      - æ•°æ®æ ‡å‡†åŒ–: StandardScaler

ğŸ“Š è¾“å‡º: æ¸…æ´—åçš„DataFrame (1435è¡Œ x Nåˆ—)


ã€ä¸‰ã€Layer 2: ç‰¹å¾å·¥ç¨‹å±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”§ FeatureEngineer (src/features/engineer.py):

åˆ›å»ºçš„ç‰¹å¾ç±»å‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‰¹å¾ç±»å‹         â”‚ å…·ä½“ç‰¹å¾                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ»åç‰¹å¾         â”‚ total_lag1, total_lag2, total_lag3                     â”‚
â”‚ æ»šåŠ¨ç»Ÿè®¡         â”‚ total_ma3, total_ma5, total_std3                       â”‚
â”‚ è¶‹åŠ¿ç‰¹å¾         â”‚ total_trend, total_momentum                            â”‚
â”‚ ä¸»åŠå›½ç‰¹å¾       â”‚ is_host (0/1)                                          â”‚
â”‚ å¹´åº¦ç‰¹å¾         â”‚ year_normalized                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š è¾“å‡º: ç‰¹å¾å¢å¼ºåçš„DataFrame (16+ä¸ªç‰¹å¾åˆ—)


ã€å››ã€Layer 3: æ¨¡å‹è®­ç»ƒå±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¤– æœºå™¨å­¦ä¹ æ¨¡å‹ (src/models/):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨¡å‹            â”‚ é…ç½®                â”‚ æ€§èƒ½æŒ‡æ ‡                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ XGBoost         â”‚ n_estimators=100    â”‚ RMSE=1.65, MAE=0.94, RÂ²=0.993     â”‚
â”‚                 â”‚ max_depth=4         â”‚                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LightGBM        â”‚ n_estimators=100    â”‚ RMSE=2.17, MAE=1.22, RÂ²=0.988     â”‚
â”‚                 â”‚ max_depth=4         â”‚                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RandomForest    â”‚ n_estimators=100    â”‚ RMSE=2.45, MAE=1.45, RÂ²=0.985     â”‚
â”‚                 â”‚ max_depth=6         â”‚                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ARIMA           â”‚ auto_order          â”‚ æ—¶é—´åºåˆ—é¢„æµ‹ (å¢å¼ºåˆ†æ)           â”‚
â”‚                 â”‚ (p,d,q)             â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”— EnsemblePredictor (src/models/ensemble.py):
   - åŠ æƒå¹³å‡èåˆå¤šä¸ªæ¨¡å‹é¢„æµ‹
   - æƒé‡åŸºäºéªŒè¯é›†æ€§èƒ½è‡ªåŠ¨è°ƒæ•´


ã€äº”ã€Layer 4: ä¼˜åŒ–è°ƒæ•´å±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš¡ ä¸»åŠå›½æ•ˆåº”è°ƒæ•´ (src/optimization/host_effect.py):
   - HostEffectAdjuster
   - ç¾å›½2028ä¸»åœº: +20% å¥–ç‰Œé¢„æµ‹æå‡
   - å†å²æ•°æ®éªŒè¯: å¹³å‡ä¸»åœºæ•ˆåº” +82.6%

ğŸ² ä¸ç¡®å®šæ€§é‡åŒ– (src/optimization/bayesian.py):
   - BayesianUncertainty
   - Bootstrapé‡é‡‡æ ·: 1000æ¬¡
   - è¾“å‡º: 95%ç½®ä¿¡åŒºé—´ [lower_bound, upper_bound]


ã€å…­ã€Layer 5: æ¨¡å‹éªŒè¯å±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… BacktestValidator (src/validation/backtest.py):
   - æ—¶é—´åºåˆ—äº¤å‰éªŒè¯ (3-fold)
   - é¿å…æ•°æ®æ³„éœ² (æœªæ¥ä¿¡æ¯ä¸ä¼šæ³„éœ²åˆ°è®­ç»ƒé›†)

ğŸ“Š ModelEvaluator (src/validation/evaluator.py):
   - RMSE (å‡æ–¹æ ¹è¯¯å·®)
   - MAE (å¹³å‡ç»å¯¹è¯¯å·®)
   - RÂ² (å†³å®šç³»æ•°)
   - MAPE (å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®)

ğŸ” SensitivityAnalyzer (src/validation/sensitivity.py):
   - ç‰¹å¾æ•æ„Ÿåº¦åˆ†æ
   - è¯†åˆ«å…³é”®å½±å“å› ç´ 
   - Top 5æ•æ„Ÿç‰¹å¾: total_ma3, total_ma5, total_lag1, total_lag2, total_std3


ã€ä¸ƒã€Layer 6: æ·±åº¦åˆ†æå±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ ç»Ÿè®¡æ£€éªŒ (enhanced_analysis.py):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€éªŒæ–¹æ³•            â”‚ ç›®çš„                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ADFæ£€éªŒ             â”‚ éªŒè¯æ—¶é—´åºåˆ—å¹³ç¨³æ€§                                  â”‚
â”‚ Grangerå› æœæ£€éªŒ     â”‚ éªŒè¯é¡¹ç›®æ•°â†’å¥–ç‰Œæ•°çš„å› æœå…³ç³»                        â”‚
â”‚ Pearsonç›¸å…³         â”‚ çº¿æ€§ç›¸å…³æ€§åˆ†æ (r=0.9991)                          â”‚
â”‚ Spearmanç›¸å…³        â”‚ ç§©ç›¸å…³æ€§åˆ†æ (Ï=0.9959)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒ åŒºåŸŸåˆ†æ (complete_mcm_analysis.py):
   - å—ç¾å›½å®¶åˆ†æ: å·´è¥¿ã€é˜¿æ ¹å»·ã€æ™ºåˆ©ç­‰8å›½
   - åœ°ç†åˆ†å¸ƒçƒ­åŠ›å›¾: 6å¤§æ´²å¥–ç‰Œåˆ†å¸ƒ

ğŸ¾ ä¸“é¢˜åˆ†æ:
   - æ•™ç»ƒæ•ˆåº”: è‚¯å°¼äºš(+51.7%), ç‰™ä¹°åŠ (+186%), æ–°åŠ å¡(+33.3%)
   - é¡¹ç›®-å¥–ç‰Œå…³ç³»: çº¿æ€§å›å½’ RÂ²=0.990


ã€å…«ã€Layer 7: è¾“å‡ºç”Ÿæˆå±‚ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“„ PredictionReporter (src/output/reporter.py):
   ç”Ÿæˆçš„æŠ¥å‘Š:
   â”œâ”€â”€ predictions_2028.csv          - é¢„æµ‹ç»“æœCSV
   â”œâ”€â”€ summary_report.txt            - åŸºç¡€é¢„æµ‹æŠ¥å‘Š
   â”œâ”€â”€ comprehensive_analysis_report.txt - ç»¼åˆåˆ†ææŠ¥å‘Š
   â”œâ”€â”€ complete_mcm_analysis_report.txt  - MCMå®Œæ•´æŠ¥å‘Š
   â””â”€â”€ mcm_c_enhanced_analysis_report.txt - å¢å¼ºç‰ˆæŠ¥å‘Š

ğŸ¨ Visualizer (src/output/visualizer.py):
   ç”Ÿæˆçš„å›¾è¡¨ (17ä¸ª):
   â”œâ”€â”€ [1-7]  åŸºç¡€åˆ†æå›¾è¡¨ (å†å²è¶‹åŠ¿ã€å¥–ç‰Œåˆ†å¸ƒã€æ¨¡å‹å¯¹æ¯”ç­‰)
   â”œâ”€â”€ [8-12] MCMä¸“é¢˜å›¾è¡¨ (å—ç¾åˆ†æã€æ•™ç»ƒæ•ˆåº”ã€æ•æ„Ÿæ€§ç­‰)
   â””â”€â”€ [13-17] å¢å¼ºç‰ˆå›¾è¡¨ (ä¸»åœºæ•ˆåº”ã€Bootstrapã€æ—¶åºåˆ†è§£ç­‰)


ã€ä¹ã€æ‰§è¡Œæµç¨‹ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš€ ä¸»ç¨‹åºå…¥å£:

# æ–¹å¼1: åŸºç¡€é¢„æµ‹ (main.py)
python3 src/main.py --mode predict

# æ–¹å¼2: å®Œæ•´åˆ†æ (full_analysis.py)
python3 src/full_analysis.py

# æ–¹å¼3: MCMä¸“é¢˜åˆ†æ (complete_mcm_analysis.py)
python3 src/complete_mcm_analysis.py

# æ–¹å¼4: å¢å¼ºç‰ˆæ·±åº¦åˆ†æ (enhanced_analysis.py)
python3 src/enhanced_analysis.py

# æ–¹å¼5: ç”Ÿæˆç®—æ³•çŸ¥è¯†åº“
python3 çŸ¥è¯†åº“/ç”Ÿæˆç®—æ³•çŸ¥è¯†åº“.py


ã€åã€2028æ´›æ‰çŸ¶å¥¥è¿ä¼šé¢„æµ‹ç»“æœã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ† Top 10 é¢„æµ‹æ’å:

â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ’å â”‚ å›½å®¶             â”‚ é¢„æµ‹å¥–ç‰Œæ•°  â”‚ 95%ç½®ä¿¡åŒºé—´             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1   â”‚ ğŸ‡ºğŸ‡¸ ç¾å›½ (ä¸»åŠå›½) â”‚ 230         â”‚ [-97, 557]              â”‚
â”‚  2   â”‚ ğŸ‡¨ğŸ‡³ ä¸­å›½          â”‚ 90.3        â”‚ [0, 124]                â”‚
â”‚  3   â”‚ ğŸ‡¬ğŸ‡§ è‹±å›½          â”‚ 64.4        â”‚ [0, 90]                 â”‚
â”‚  4   â”‚ ğŸ‡·ğŸ‡º ä¿„ç½—æ–¯        â”‚ 60.3        â”‚ [0, 132.5]              â”‚
â”‚  5   â”‚ ğŸ‡¯ğŸ‡µ æ—¥æœ¬          â”‚ 52.3        â”‚ [0, 76]                 â”‚
â”‚  6   â”‚ ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºš      â”‚ 51.9        â”‚ [0, 76]                 â”‚
â”‚  7   â”‚ ğŸ‡©ğŸ‡ª å¾·å›½          â”‚ 48.7        â”‚ [17, 103]               â”‚
â”‚  8   â”‚ ğŸ‡«ğŸ‡· æ³•å›½          â”‚ 42.1        â”‚ [3, 79.5]               â”‚
â”‚  9   â”‚ ğŸ‡®ğŸ‡¹ æ„å¤§åˆ©        â”‚ 40.0        â”‚ -                       â”‚
â”‚ 10   â”‚ ğŸ‡³ğŸ‡± è·å…°          â”‚ 35.7        â”‚ -                       â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ã€åä¸€ã€é¡¹ç›®ç›®å½•ç»“æ„ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è‚–æƒ å¨ç¾èµ›/
â”œâ”€â”€ data/                           # è¾“å…¥æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ summerOly_medal_counts.csv
â”‚   â”œâ”€â”€ summerOly_hosts.csv
â”‚   â”œâ”€â”€ summerOly_programs.csv
â”‚   â””â”€â”€ summerOly_athletes.csv
â”‚
â”œâ”€â”€ src/                            # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ config.py                   # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ enhanced_analysis.py        # å¢å¼ºç‰ˆåˆ†æ
â”‚   â”œâ”€â”€ full_analysis.py            # å®Œæ•´åˆ†æ
â”‚   â”œâ”€â”€ complete_mcm_analysis.py    # MCMä¸“é¢˜åˆ†æ
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                       # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ loader.py
â”‚   â”‚   â”œâ”€â”€ merger.py
â”‚   â”‚   â”œâ”€â”€ preprocessor.py
â”‚   â”‚   â””â”€â”€ cleaner.py
â”‚   â”‚
â”‚   â”œâ”€â”€ features/                   # ç‰¹å¾å·¥ç¨‹æ¨¡å—
â”‚   â”‚   â””â”€â”€ engineer.py
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                     # æ¨¡å‹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ xgboost_model.py
â”‚   â”‚   â”œâ”€â”€ lightgbm_model.py
â”‚   â”‚   â”œâ”€â”€ random_forest_model.py
â”‚   â”‚   â”œâ”€â”€ arima_model.py
â”‚   â”‚   â”œâ”€â”€ lstm_model.py
â”‚   â”‚   â”œâ”€â”€ prophet_model.py
â”‚   â”‚   â””â”€â”€ ensemble.py
â”‚   â”‚
â”‚   â”œâ”€â”€ optimization/               # ä¼˜åŒ–æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ host_effect.py
â”‚   â”‚   â”œâ”€â”€ bayesian.py
â”‚   â”‚   â””â”€â”€ event_change.py
â”‚   â”‚
â”‚   â”œâ”€â”€ validation/                 # éªŒè¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ backtest.py
â”‚   â”‚   â”œâ”€â”€ evaluator.py
â”‚   â”‚   â””â”€â”€ sensitivity.py
â”‚   â”‚
â”‚   â”œâ”€â”€ analysis/                   # åˆ†ææ¨¡å—
â”‚   â”‚   â”œâ”€â”€ regional.py
â”‚   â”‚   â”œâ”€â”€ event_impact.py
â”‚   â”‚   â””â”€â”€ coach_effect.py
â”‚   â”‚
â”‚   â””â”€â”€ output/                     # è¾“å‡ºæ¨¡å—
â”‚       â”œâ”€â”€ reporter.py
â”‚       â””â”€â”€ visualizer.py
â”‚
â”œâ”€â”€ output/                         # è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ predictions_2028.csv
â”‚   â”œâ”€â”€ summary_report.txt
â”‚   â”œâ”€â”€ comprehensive_analysis_report.txt
â”‚   â”œâ”€â”€ complete_mcm_analysis_report.txt
â”‚   â”œâ”€â”€ mcm_c_enhanced_analysis_report.txt
â”‚   â””â”€â”€ figures/                    # å›¾è¡¨ç›®å½• (17ä¸ªPNG)
â”‚
â”œâ”€â”€ çŸ¥è¯†åº“/                          # çŸ¥è¯†åº“ç›®å½•
â”‚   â”œâ”€â”€ ç®—æ³•çŸ¥è¯†åº“_37_algorithms.xlsx
â”‚   â”œâ”€â”€ MCM_Cé¢˜_å›¾è¡¨çŸ¥è¯†åº“.csv
â”‚   â””â”€â”€ ç”Ÿæˆç®—æ³•çŸ¥è¯†åº“.py
â”‚
â””â”€â”€ MCMICM/2024/C/                   # MCMåŸå§‹æ•°æ®ä¸è®ºæ–‡
    â”œâ”€â”€ data_dictionary.csv
    â”œâ”€â”€ Wimbledon_featured_matches.csv
    â””â”€â”€ student paper/              # 11ç¯‡ä¼˜ç§€è®ºæ–‡


================================================================================
                              æµç¨‹å›¾å·²ç”Ÿæˆå®Œæˆï¼
================================================================================
"""

def generate_html_flowchart():
    """ç”ŸæˆHTMLæ ¼å¼çš„æµç¨‹å›¾"""
    html_content = """<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MCM Cé¢˜ - å¥¥è¿å¥–ç‰Œé¢„æµ‹ç³»ç»Ÿæµç¨‹å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        h1 { text-align: center; color: #333; }
        .mermaid { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <h1>ğŸ… MCM Cé¢˜ - å¥¥è¿å¥–ç‰Œé¢„æµ‹ç³»ç»Ÿæµç¨‹å›¾</h1>
    <h2>2028 Los Angeles Olympics Prediction System</h2>
    
    <div class="mermaid">
    graph TB
        subgraph æ•°æ®å±‚["ğŸ“Š æ•°æ®å¤„ç†å±‚"]
            A1[medal_counts.csv] --> B1[DataLoader]
            A2[hosts.csv] --> B1
            B1 --> C1[DataMerger]
            C1 --> D1[DataPreprocessor]
        end
        
        subgraph ç‰¹å¾å±‚["ğŸ”§ ç‰¹å¾å·¥ç¨‹å±‚"]
            D1 --> E1[FeatureEngineer]
            E1 --> F1[æ»åç‰¹å¾]
            E1 --> F2[æ»šåŠ¨ç»Ÿè®¡]
            E1 --> F3[è¶‹åŠ¿ç‰¹å¾]
        end
        
        subgraph æ¨¡å‹å±‚["ğŸ¤– æ¨¡å‹è®­ç»ƒå±‚"]
            F1 --> G1[XGBoost]
            F2 --> G2[LightGBM]
            F3 --> G3[RandomForest]
            F1 --> G4[ARIMA]
            G1 --> H1[Ensemble<br/>æ¨¡å‹èåˆ]
            G2 --> H1
            G3 --> H1
            G4 --> H1
        end
        
        subgraph ä¼˜åŒ–å±‚["âš¡ ä¼˜åŒ–è°ƒæ•´å±‚"]
            H1 --> I1[ä¸»åŠå›½æ•ˆåº”<br/>+20%]
            I1 --> J1[Bootstrap<br/>ä¸ç¡®å®šæ€§é‡åŒ–]
            J1 --> J2[95%ç½®ä¿¡åŒºé—´]
        end
        
        subgraph éªŒè¯å±‚["âœ… éªŒè¯å±‚"]
            H1 --> K1[å›æµ‹éªŒè¯]
            H1 --> K2[æ•æ„Ÿæ€§åˆ†æ]
        end
        
        subgraph åˆ†æå±‚["ğŸ“ˆ æ·±åº¦åˆ†æå±‚"]
            J2 --> M1[ç»Ÿè®¡æ£€éªŒ<br/>ADF/Granger]
            J2 --> M2[åŒºåŸŸåˆ†æ<br/>å—ç¾/åœ°ç†]
            J2 --> M3[æ•™ç»ƒæ•ˆåº”<br/>æ¡ˆä¾‹ç ”ç©¶]
        end
        
        subgraph è¾“å‡ºå±‚["ğŸ“„ è¾“å‡ºå±‚"]
            J2 --> P1[predictions.csv]
            K1 --> P2[reports.txt]
            K2 --> P2
            M1 --> P3[17ä¸ªå¯è§†åŒ–å›¾è¡¨]
            M2 --> P3
            M3 --> P3
        end
    </div>
    
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</body>
</html>
"""
    return html_content


def main():
    """ä¸»å‡½æ•°"""
    print(WORKFLOW_DESCRIPTION)
    
    # ä¿å­˜Mermaidæµç¨‹å›¾
    output_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
    
    # ä¿å­˜HTMLç‰ˆæœ¬
    html_path = os.path.join(output_dir, "output", "é¡¹ç›®æµç¨‹å›¾.html")
    os.makedirs(os.path.dirname(html_path), exist_ok=True)
    
    with open(html_path, 'w', encoding='utf-8') as f:
        f.write(generate_html_flowchart())
    
    print(f"\nâœ… HTMLæµç¨‹å›¾å·²ä¿å­˜è‡³: {html_path}")
    print("\nğŸ“‹ Mermaidæµç¨‹å›¾ä»£ç :")
    print(MERMAID_FLOWCHART)


if __name__ == "__main__":
    main()
