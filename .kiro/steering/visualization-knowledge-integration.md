# 可视化知识库集成指南 (Visualization Knowledge Base Integration Guide)

## 📊 系统概览

两个题型的可视化知识库已完成集成，可通过 `@knowledge:viz` 调用。

### 知识库文件

| 题型 | 文件路径 | 可视化数量 | 核心特点 |
|------|---------|-----------|---------|
| **C题** | `C题/知识库/C题可视化知识库.csv` | **92种** (76图+16表) | 时间序列预测、聚类分析、回归建模、深度学习 |
| **E题** | `E题/知识库/E题可视化知识库.csv` | **72种** (71图+1表) | 多准则决策、优化评价、风险分析、生态评估 |

---

## 🎯 C题可视化知识库 (Olympic Medal Prediction)

### 文件信息
- **路径**: [C题/知识库/C题可视化知识库.csv](../../C题/知识库/C题可视化知识库.csv)
- **规模**: 92种可视化类型
- **适用**: 奥运奖牌预测、时间序列分析、运动数据建模

### 核心可视化类别

#### 1. 基础可视化 (10种)
- 奥运奖牌历史趋势折线图
- 多国奖牌对比柱状图
- 堆叠柱状图(金银铜牌)
- 区域/大洲奖牌分布饼图
- 奥运项目奖牌分布图
- 地理空间分布图
- 案例研究地理位置图
- 2028奥运预测结果图
- 历届奥运主办城市地图
- 运动员年龄分布直方图

#### 2. 时间序列与预测 (12种)
- **ARIMA预测曲线图** (使用频次: 11次)
- **LSTM预测对比图** (使用频次: 10次)
- 多模型预测效果对比图
- 残差分析图
- Q-Q图(正态性检验)
- 时间序列自相关图(ACF/PACF)
- 趋势-季节-残差分解图
- 时间序列平稳性检验图
- ARIMA参数识别表
- ADF单位根检验表
- Ljung-Box残差检验表
- 协整检验结果表

#### 3. 聚类与降维 (9种)
- **K-means聚类散点图** (使用频次: 7次)
- 层次聚类树状图
- 聚类轮廓系数图
- 主成分分析载荷图 (使用频次: 6次)
- 主成分累计贡献率图
- 因子分析路径图
- 聚类结果统计表
- 主成分方差贡献表
- 因子载荷矩阵表

#### 4. 回归与相关性 (8种)
- GDP与奖牌数散点图
- 人口与奖牌数回归拟合图
- 多元线性回归系数图 (使用频次: 7次)
- 回归诊断图(残差vs拟合值)
- Lasso回归路径图
- 岭回归交叉验证图
- 特征相关性热力图
- VIF多重共线性检验表

#### 5. 树模型与集成 (8种)
- **XGBoost训练曲线图** (使用频次: 5次)
- **随机森林OOB误差图** (使用频次: 3次)
- 特征重要性条形图(树模型)
- SHAP值解释图
- 决策树可视化图 (使用频次: 4次)
- 学习曲线图
- 验证曲线图
- 集成学习权重分配图

#### 6. 深度学习 (8种)
- **神经网络训练损失曲线图** (使用频次: 10次)
- GRU/LSTM单元结构图 (使用频次: 2次)
- 激活函数对比图
- 梯度消失/爆炸监控图
- Attention权重热力图
- 模型架构流程图
- 模型融合流程图
- 训练-验证-测试分割示意图

#### 7. 模型评估 (10种)
- 混淆矩阵热力图
- ROC曲线与AUC值
- PR曲线(Precision-Recall)
- 性能指标雷达图
- 预测区间图
- 交叉验证折数误差图
- 网格搜索参数热力图
- 贝叶斯优化迭代图
- 模型性能对比表
- 训练集-测试集性能对比表

#### 8. 不确定性与敏感性 (5种)
- 蒙特卡洛模拟分布图
- 情景分析对比图
- 敏感性分析龙卷风图
- 遗传算法进化曲线图 (使用频次: 2次)
- 超参数设置汇总表

#### 9. 领域特定 (6种)
- 主办国效应分析图
- 新增/取消项目影响图
- 教练更换影响图
- 世界排名变化趋势图
- 国家间奖牌差距图
- 奖牌增长率热力图

### 使用示例

```bash
# 查询时间序列预测图表
@knowledge:viz 检索ARIMA预测 → C题可视化知识库.csv 行7
@knowledge:viz 检索LSTM预测 → C题可视化知识库.csv 行8

# 查询聚类分析图表
@knowledge:viz 检索K-means → C题可视化知识库.csv 行14
@knowledge:viz 检索PCA → C题可视化知识库.csv 行18

# 查询模型解释图表
@knowledge:viz 检索SHAP → C题可视化知识库.csv 行28
@knowledge:viz 检索特征重要性 → C题可视化知识库.csv 行27

# 查询奥运特定图表
@knowledge:viz 检索主办国效应 → C题可视化知识库.csv 行42
@knowledge:viz 检索2028预测 → C题可视化知识库.csv 行68
```

---

## 🌍 E题可视化知识库 (Environmental Policy/Light Pollution)

### 文件信息
- **路径**: [E题/知识库/E题可视化知识库.csv](../../E题/知识库/E题可视化知识库.csv)
- **规模**: 72种可视化类型
- **适用**: 环境评价、光污染分析、生态决策、风险评估

### 核心可视化类别

#### 1. 多准则决策 (10种)
- **AHP权重分布饼图** (使用频次: 24次)
- AHP层次结构图
- 一致性检验结果表
- **TOPSIS排序结果条形图** (使用频次: 19次)
- TOPSIS正负理想解对比图
- **熵权法权重计算流程图** (使用频次: 21次)
- 熵权法vs AHP权重对比图
- 综合权重雷达图
- AHP判断矩阵表
- TOPSIS标准化矩阵表

#### 2. 优化与评价 (9种)
- **DEA效率前沿面图** (使用频次: 9次)
- DEA效率得分排序图
- GE矩阵战略定位图
- GE矩阵转换点分析图
- 模糊综合评价隶属度图
- 模糊评价等级分布图
- 多目标规划帕累托前沿图
- 目标规划结果对比图
- DEA投入产出指标表

#### 3. 风险分析 (7种)
- 风险评估矩阵图
- 风险指数时间序列图
- 破产概率曲线图
- 成本效益分析图
- 信息扩散风险曲线图
- 风险等级划分标准表
- 极端天气事件统计表

#### 4. 灰色系统 (3种)
- 灰色关联度热力图
- 灰色预测曲线图 (GM(1,1))
- 组合权重计算结果表

#### 5. 环境与生态 (11种)
- 碳汇量时间演变图
- 碳循环流程示意图
- Logistic增长曲线图
- 森林价值评估指标体系图
- 土地利用变化图
- 光污染空间分布图
- 生态足迹对比图
- 可持续发展指标雷达图
- 碳汇转换系数表
- 碳价格情景假设表
- 管理策略参数对比表

#### 6. 敏感性与情景 (4种)
- 蒙特卡洛模拟分布图
- 情景分析对比图
- 敏感性分析龙卷风图
- 权重敏感性分析图

#### 7. 通用图表 (8种)
- 双轴对比折线图
- 堆叠面积图
- 桑基图
- 树状图(决策树)
- 相关性系数矩阵热力图
- 主成分分析载荷图
- 聚类分析树状图
- K-means聚类散点图

### 使用示例

```bash
# 查询多准则决策图表
@knowledge:viz 检索AHP → E题可视化知识库.csv 行2-4
@knowledge:viz 检索TOPSIS → E题可视化知识库.csv 行5-6
@knowledge:viz 检索熵权法 → E题可视化知识库.csv 行7-8

# 查询优化评价图表
@knowledge:viz 检索DEA → E题可视化知识库.csv 行14-15
@knowledge:viz 检索GE矩阵 → E题可视化知识库.csv 行10-11

# 查询风险分析图表
@knowledge:viz 检索风险矩阵 → E题可视化知识库.csv 行18
@knowledge:viz 检索蒙特卡洛 → E题可视化知识库.csv 行28

# 查询环境生态图表
@knowledge:viz 检索光污染 → E题可视化知识库.csv 行43
@knowledge:viz 检索碳汇 → E题可视化知识库.csv 行22
```

---

## �� 系统集成方式

### 1. .cursorrules 快速命令

```yaml
# 可视化知识库调用
@knowledge:viz 检索{图表类型} 
  → C题: C题可视化知识库.csv (92种)
  → E题: E题可视化知识库.csv (72种)
```

### 2. mcm_ultimate_system.md 知识库映射

```yaml
knowledge_base:
  visualization:
    - path: "C题/知识库/C题可视化知识库.csv"
      usage: "C题图表类型选择 (92种可视化: ARIMA/LSTM/XGBoost/聚类/回归)"
    - path: "E题/知识库/E题可视化知识库.csv"
      usage: "E题图表类型选择 (72种可视化: AHP/TOPSIS/DEA/风险评估)"
```

### 3. Agent调用协议

```yaml
@strategist:
  - 审题阶段引用可视化类型指导模型选择
  - 创新发散时考虑图表表达创新点

@executor:
  - 实现阶段根据模型选择对应图表
  - 生成高质量可视化(300 DPI, grayscale-readable)
  - 每张图必须有informative caption

@redcell:
  - 检查图表是否自解释
  - 验证图表与正文一致性
  - 确认所有图表被引用
```

---

## 📈 对比总结

| 维度 | C题 (Olympic) | E题 (Environment) |
|------|--------------|------------------|
| **总数** | 92种 (76图+16表) | 72种 (71图+1表) |
| **核心模型** | ARIMA(11), LSTM(10), 神经网络(10), K-means(7), XGBoost(5) | AHP(24), EWM(21), TOPSIS(19), BP(17), GM(15) |
| **分析重点** | 时间序列预测、聚类分类、回归拟合、深度学习 | 多准则决策、优化评价、风险分析、灰色预测 |
| **统计检验** | ADF平稳性、Ljung-Box残差、Granger因果、协整 | 一致性检验CR、模糊评价、信息扩散 |
| **特色图表** | ACF/PACF、ROC曲线、SHAP解释、训练曲线、主办国效应 | AHP层次图、TOPSIS理想解、DEA前沿面、桑基图、光污染地图 |
| **评估方法** | RMSE/MAE/R²/MAPE、交叉验证、网格搜索、贝叶斯优化 | 权重敏感性、情景分析、蒙特卡洛、转换点分析 |

---

## ✅ 集成检查清单

### Phase 1: 审题阶段 (0-12h)
- [ ] 根据题目类型选择对应可视化知识库
- [ ] @strategist 引用可视化知识库指导战略规划
- [ ] 确定核心图表类型(流程图、模型架构图)

### Phase 2: 建模阶段 (12-72h)
- [ ] @executor 根据模型选择对应可视化
- [ ] 生成模型结果图(预测曲线、聚类散点、回归拟合)
- [ ] 生成解释图(SHAP、特征重要性、权重分布)

### Phase 3: 写作阶段 (48-96h)
- [ ] 所有图表 300 DPI、grayscale-readable
- [ ] 每张图有informative caption
- [ ] 所有图表在正文被引用和讨论

### Phase 4: 检查阶段 (96-100h)
- [ ] @redcell 检查图表自解释性
- [ ] 验证图表编号连续
- [ ] 确认图表与文字一致

---

## 🚀 快速查询速查表

### C题高频图表 Top 10

| 排名 | 图表类型 | 使用场景 | 行号 |
|------|---------|---------|-----|
| 1 | ARIMA预测曲线图 | 时间序列预测 | 7 |
| 2 | LSTM预测对比图 | 深度学习预测 | 8 |
| 3 | 特征相关性热力图 | 特征选择 | 17 |
| 4 | K-means聚类散点图 | 国家分类 | 14 |
| 5 | SHAP值解释图 | 模型可解释性 | 28 |
| 6 | XGBoost训练曲线图 | 监控过拟合 | 31 |
| 7 | 主成分分析载荷图 | 降维解释 | 18 |
| 8 | 性能指标雷达图 | 综合评估 | 37 |
| 9 | 敏感性分析龙卷风图 | 参数影响 | 41 |
| 10 | 主办国效应分析图 | 领域特定 | 42 |

### E题高频图表 Top 10

| 排名 | 图表类型 | 使用场景 | 行号 |
|------|---------|---------|-----|
| 1 | AHP权重分布饼图 | 权重确定 | 2 |
| 2 | 熵权法权重流程图 | 客观赋权 | 7 |
| 3 | TOPSIS排序条形图 | 方案排序 | 5 |
| 4 | AHP层次结构图 | 层次展示 | 3 |
| 5 | DEA效率前沿面图 | 效率评价 | 14 |
| 6 | 综合权重雷达图 | 多维展示 | 9 |
| 7 | 风险评估矩阵图 | 风险分析 | 18 |
| 8 | 蒙特卡洛分布图 | 不确定性 | 28 |
| 9 | 灰色预测曲线图 | 趋势预测 | 13 |
| 10 | 桑基图 | 流量分布 | 34 |

---

**最后更新**: 2026-01-24  
**系统状态**: ✅ 已完成集成  
**使用频率**: ⭐⭐⭐⭐⭐ 赛时核心参考
