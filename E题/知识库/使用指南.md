# E题知识库使用指南

## 📚 知识库文件清单

### 1. 模型库文件
- **[E题模型库.xlsx](E题模型库.xlsx)** ⭐⭐⭐⭐⭐
  - **Sheet 1: 模型总览** - 15个高频模型 (AHP 24次, EWM 21次, TOPSIS 19次...)
  - **Sheet 2: 决策评价类** - AHP/EWM/TOPSIS/DEA详解
  - **Sheet 3: 经典组合方案** - 7种经典组合 (AHP+TOPSIS 18次, EWM+TOPSIS 16次...)

### 2. 统计分析文件
- **[E题分析统计报告.txt](E题分析统计报告.txt)** - 模型使用频次统计
- **[E题_完整统计分析.txt](../E题_完整统计分析.txt)** - 完整论文分析数据

### 3. 可视化参考
- **[E题可视化知识库.csv](E题可视化知识库.csv)** - 图表类型选择指南

### 4. 写作模板
- **[E题_写作模板_Abstract.md](../E题_写作模板_Abstract.md)** - O奖摘要写作模板

### 5. 代码实现
- **[src/models/ahp_model.py](../src/models/ahp_model.py)** - AHP层次分析法
- **[src/models/ewm_model.py](../src/models/ewm_model.py)** - 熵权法
- **[src/models/topsis_model.py](../src/models/topsis_model.py)** - TOPSIS

---

## 🎯 赛时使用流程

### Phase 1: 审题阶段 (0-12h)
**参考文件：**
1. `.kiro/steering/E题-battle-quick-reference.md` - 快速决策参考
2. `.kiro/steering/E题-modeling-prompts-final.md` - 建模提示词
3. `.kiro/steering/data-sources-and-brainstorm.md` - 数据源和脑暴

**使用Agent：**
```
@strategist 审题 → 参考E题-battle-quick-reference.md的三问定位
@strategist 发散创新路径 → 参考E题-modeling-prompts-final.md
@knowledge:model 检索{任务类型}相关模型 → 查询E题模型库.xlsx
```

### Phase 2: 建模阶段 (12-72h)
**参考文件：**
1. `E题/知识库/E题模型库.xlsx` - 模型选择决策
   - **决策评价问题** → Sheet 2: AHP/EWM/TOPSIS/DEA
   - **预测问题** → Sheet 1: GM/ARIMA/BP/Random Forest
   - **优化问题** → Sheet 1: GA/Monte Carlo/PSO
2. `E题/src/models/*.py` - 代码实现参考

**使用Agent：**
```
@executor 实现路径{N} → 参考E题模型库.xlsx选择模型
@executor 特征工程 → 参考modeling-prompts中的四类特征
@executor 生成SHAP解释 → 必须包含可解释性
```

### Phase 3: 写作阶段 (48-96h)
**参考文件：**
1. `E题/E题_写作模板_Abstract.md` - 摘要写作
2. `E题/知识库/E题可视化知识库.csv` - 图表选择
3. `.kiro/steering/生成图的提示词.txt` - Nano Banana提示词

**使用Agent：**
```
@executor 撰写{章节} → 参考E题_写作模板_Abstract.md
@knowledge:viz 检索{图表类型} → 查询E题可视化知识库.csv
Nano Banana生成图表 → 使用生成图的提示词.txt
```

### Phase 4: 检查阶段 (96-100h)
**参考文件：**
1. `.kiro/steering/battle-quick-reference.md` - 提交前检查清单
2. `.cursorrules` - 系统配置规则

**使用Agent：**
```
@redcell 提交前检查 → 参考battle-quick-reference.md
@redcell 攻击假设 → 检查E题模型库.xlsx中的"常见陷阱"
@redcell 格式攻击 → 对照提交规范
```

---

## 💡 高频模型使用指南

### 🥇 Top 3 模型组合（必会）

#### 1. **AHP+TOPSIS** (18次O奖论文使用)
- **场景**: 光污染因素权重 + 缓解方案排序
- **步骤**:
  1. AHP确定主观权重 → 参考 `src/models/ahp_model.py`
  2. TOPSIS综合排序 → 参考 `src/models/topsis_model.py`
- **加分点**: AHP+EWM组合赋权（主客观结合）

#### 2. **EWM+TOPSIS** (16次O奖论文使用)
- **场景**: 纯客观评价区域光污染水平
- **步骤**:
  1. EWM计算客观权重 → 参考 `src/models/ewm_model.py`
  2. TOPSIS排序 → 参考 `src/models/topsis_model.py`
- **优势**: 完全客观、避免主观偏差

#### 3. **遗传算法+BP神经网络** (14次O奖论文使用)
- **场景**: 优化神经网络预测光污染
- **步骤**:
  1. GA搜索最优参数
  2. BP训练和预测
- **代码复杂度**: ★★★★★ (需提前准备)

---

## ⚠️ 常见陷阱（来自E题模型库.xlsx）

### AHP常见陷阱
- ❌ 判断矩阵CR>0.1不通过
- ❌ 赋值主观性强
- ✅ 解决: 使用AHP+EWM组合赋权

### TOPSIS常见陷阱
- ❌ 未处理指标类型（正向/负向）
- ❌ 未归一化
- ✅ 解决: 数据预处理+类型标注

### BP神经网络常见陷阱
- ❌ 黑箱、需大量数据、易过拟合
- ✅ 解决: 使用SHAP解释 + 遗传算法调参

---

## 🚀 快速查询命令

```bash
# 查询模型使用频次
@knowledge:model 检索{模型名称} → E题模型库.xlsx Sheet 1

# 查询模型详细信息
@knowledge:model 检索{决策评价/预测/优化/聚类} → E题模型库.xlsx 对应Sheet

# 查询经典组合
@knowledge:model 检索{组合方案} → E题模型库.xlsx Sheet 3

# 查询代码实现
参考: E题/src/models/{模型名}_model.py
```

---

## 📊 E题模型库.xlsx 快速索引

| 需求类型 | 推荐模型 | 使用频次 | 难度 | 代码位置 |
|---------|---------|---------|------|---------|
| **权重确定** | AHP | 24次 | ★★☆☆☆ | `src/models/ahp_model.py` |
| **客观赋权** | EWM | 21次 | ★★☆☆☆ | `src/models/ewm_model.py` |
| **方案排序** | TOPSIS | 19次 | ★★★☆☆ | `src/models/topsis_model.py` |
| **非线性预测** | BP神经网络 | 17次 | ★★★★☆ | sklearn/tensorflow |
| **小样本预测** | GM灰色预测 | 15次 | ★★☆☆☆ | statsmodels |
| **降维处理** | PCA | 14次 | ★★★☆☆ | sklearn |
| **分类预测** | 随机森林 | 11次 | ★★★☆☆ | sklearn |
| **时序预测** | ARIMA | 10次 | ★★★☆☆ | statsmodels |
| **效率评价** | DEA | 9次 | ★★★★☆ | pydea |
| **不确定性分析** | 蒙特卡洛 | 8次 | ★★★☆☆ | numpy/scipy |
| **参数优化** | 遗传算法 | 7次 | ★★★★☆ | scipy/deap |

---

## 🎓 关键提醒

1. **模型选择原则**: 
   - 决策评价问题 → AHP/EWM/TOPSIS/DEA
   - 预测问题 → GM/ARIMA/BP/随机森林
   - 优化问题 → GA/蒙特卡洛/PSO

2. **组合使用原则**:
   - 主观+客观 → AHP+EWM+TOPSIS
   - 短期+长期 → GM+ARIMA
   - 降维+预测 → PCA+回归
   - 优化+预测 → GA+BP

3. **O奖加分点**:
   - ✅ SHAP解释（必须）
   - ✅ 敏感性分析（必须）
   - ✅ 不确定性估计（必须）
   - ✅ 模型对比实验（强烈推荐）
   - ✅ 创新性组合（差异化）

4. **必须参考的文件**:
   - 审题阶段: `E题-battle-quick-reference.md`
   - 建模阶段: `E题模型库.xlsx`
   - 写作阶段: `E题_写作模板_Abstract.md`
   - 检查阶段: `battle-quick-reference.md`

---

## 📞 Agent调用示例

```markdown
# 审题阶段
@strategist 审题 → 参考E题-modeling-prompts-final.md
@knowledge:model 检索光污染评价模型 → 查询E题模型库.xlsx

# 建模阶段
@executor 实现AHP+TOPSIS组合 → 参考src/models/ahp_model.py和topsis_model.py
@executor 生成SHAP解释 → 必须包含

# 写作阶段
@executor 撰写Model Development章节 → 参考E题_写作模板_Abstract.md
@knowledge:viz 检索评价排序图表类型 → 查询E题可视化知识库.csv

# 检查阶段
@redcell 攻击假设 → 检查E题模型库.xlsx中的常见陷阱
@redcell 提交前检查 → 对照battle-quick-reference.md
```

---

**最后更新**: 2026-01-24  
**文件状态**: ✅ 已完成  
**使用频率**: ⭐⭐⭐⭐⭐ 赛时必读
